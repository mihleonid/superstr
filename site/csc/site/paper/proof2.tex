\subsection{Case Analysis}
\label{sec:proof2}
We denote the level of the vertex $ s $ by $ \lvl (s) $, and consider the three possible values of $\lvl(s)$.


\paragraph{Analysis of vertices at the level \texorpdfstring{$3$}{3}.}

In this case $ s \in {\cal S} $, and the vertex $ s $ is incident only to the arcs $ (\pref (s), s)$ and $(s, \suff (s)) $. The Collapse procedure leaves only one instance of each such arc. Hence, in the graph $ G'_{cl} $, $ C'_{cl} (s) = \{s \} $. This implies that (\ref{eqn:contradiction}) does not hold in this case.

\paragraph{Analysis of vertices at the level \texorpdfstring{$2$}{2}.}

Assume $ C'_{cl} (s) \backslash V (s) \ne\emptyset$. Choose a vertex $ t\in C'_{cl} (s) \backslash V (s)$ with the shortest weak path to $s$. Let $P = v_1 - v_2 - \ldots - v_n $ be a weak path from $s$ to $t$. In particular, $s=v_1$ and $t=v_n$.

Note that if $ \lvl (u) = 1 $, then $ u \notin V (s) $. Then $ \lvl (v_i) \ge 2 $ holds for $ i<n $, since otherwise there would be a vertex with a shorter weak path to $s$. Since for every arc $(c,d)$ of the hierarchical graph $ | \lvl (c) - \lvl (d) | = 1 $,  the levels of the vertices (possibly except the last one) of the path~$P$ alternate as follows: $ \lvl (v_1) = 2, \lvl (v_2) = 3, \lvl (v_3) = 2,\ldots$. See an example of $P$ in Figure~\ref{fig:lvl2path6}.

\begin{figure}[ht]
\begin{center}

\begin{tikzpicture}[xscale=1.3] 
  \begin{scope}
    \foreach \x/\y/\n/\m in {2/3/v2/$v_2$, 4/3/v4/$v_4$}
      \node[inputvertex] (\n) at (\x,\y) {\m};
      
    \foreach \x/\y/\n/\m in {1/2/v1/$v_1$, 3/2/v3/$v_3$, 5/2/v5/$v_5$, 6/1/v6/$v_6$}
      \node[vertex] (\n) at (\x,\y) {\m};

    
    \node[vertex] (e) at (3,0) {$\varepsilon$};
    
    \node[draw=none] at (0,0) {};
    
    \foreach \y in {0,...,3}
      \node[draw=none] at (-1,\y) {\y};
      
    \path (v1) edge[->] (v2);
    \path (v2) edge[->] (v3);
    \path (v3) edge[->] (v4);
    \path (v4) edge[->] (v5);
    \path (v5) edge[->] (v6);
  \end{scope}
\end{tikzpicture}
\end{center}

\caption{An example of a path $P$ for $n=6$.}\label{fig:lvl2path6}
\end{figure}

For a vertex $v_{2k}$ at the $\lvl (v_{2k}) = 3 $, let us denote by $u_{2k}=\pref(\suff(v_{2k}))$. The meaning of this vertex is that the pair of arcs $( v_{2k-1}, v_{2k}), (v_{2k}, v_{2k + 1})$ can potentially be collapsed into $( v_{2k-1}, u_{2k}), (u_{2k}, v_{2k + 1})$. Recall that we are considering Case~4 which means $a=b=1$, and $s=v_1$ has an up-arc and a down-arc. That is, $ G_{cl} $ contains arcs $ (u_0, v_1) $ and $ (v_1, u_2) $, where $ u_0 = \pref (s) $ and $ u_2 = \suff (s) $. 

Also, for a pair of arcs $ (u_{2k}, v_{2k + 1}) $ and $ (v_{2k + 1}, u_{2k + 2}) $ in the graph, let $ u_{2k + 1}=\pref(\suff(v_{2k + 1})) $. Again, the arcs $ (u_{2k}, v_{2k + 1}) $ and $ (v_{2k + 1}, u_{2k + 2}) $ could potentially be collapsed into $ (u_{2k}, u_{2k + 1}) $ and $ (u_{2k + 1}, u_{2k + 2}) $.

Since the arcs $ (v_{2k-1}, v_{2k}) $ and $ (v_{2k} , v_{2k + 1}) $ are the only ones that are incident to the vertex $ v_{2k} \in S $ in the hierarchical graph, the initial (doubled) solution had two copies of each of them. Moreover, since $ \lvl (s) = 2 $, all the vertices of the level $ 3 $ have already been examined, and therefore at least one collapse has been performed from each vertex $ v_ {2k} $ at the level $ 3 $. Thus, at some point the graph contained the arcs $ (v_{2k-1} , u_{2k}) $ and $ (u_{2k}, v_{2k + 1}) $ (see Figure~\ref {fig:lvl2pathuv} for an example).

\begin{figure}[ht]
\begin{center}

\begin{tikzpicture}[xscale=1.3] 
  \begin{scope}
  \foreach \x/\y/\n/\m in {2/3/v2/$v_2$, 4/3/v4/$v_4$}
      \node[inputvertex] (\n) at (\x,\y) { \m};
    \foreach \x/\y/\n/\m in {1/2/v1/$v_1$, 3/2/v3/$v_3$, 5/2/v5/$v_5$, 6/1/v6/$v_6$}
      \node[vertex] (\n) at (\x,\y) { \m};
    \foreach \x/\y/\n/\m in {0/1/u0/$u_0$, 1/0/u1/$u_1$, 2/1/u2/$u_2$, 3/0/u3/$u_3$, 4/1/u4/$u_4$, 5/0/u5/$u_5$}
      \node[vertex] (\n) at (\x,\y) { \m};
    
    \foreach \y in {0,...,3}
      \node[draw=none] at (-1,\y) {\y};
      
    \path (v1) edge[->] (v2);
    \path (v2) edge[->] (v3);
    \path (v3) edge[->] (v4);
    \path (v4) edge[->] (v5);
    \path (v5) edge[->] (v6);
    
    \draw[->] (u0) to node [sloped] {\(\not\quad\)} (v1);
    \draw[->] (v1) to node [sloped] {\(\not\quad\)} (u2);
    \path (u2) edge[->, dashed] (v3);
    \path (v3) edge[->, dashed] (u4);
    \path (u4) edge[->, dashed] (v5);
  \end{scope}
\end{tikzpicture}
\end{center}

\caption{An example of arrangement of the vertices $ v_i $ and $ u_i $ for $ n = 6 $. Note that $u_1=u_3=u_5=\varepsilon$. The graph contained the dashed arcs at some point. Removal of arcs $(u_0, v_1), (v_1, u_2)$ would violate weak connectivity of the graph.}\label{fig:lvl2pathuv}
\end{figure}

Now we will use the fact that the pair of arcs $ (u_0, v_1) $ and $ (v_1, u_2) $ has not been collapsed. This means that after this collapse, the graph would loose weak connectivity. Note that $ u_1 = \varepsilon $; after the collapse $ u_0 $ and $ u_2 $ would be weakly connected through $ \varepsilon $. This means that the weak connectivity could only be violated because there is no other weak path between $ v_1 $ and $ u_2 $.

\begin{claim}
\label{lem:pathcollapse}
For all $ k $ such that $ 3 \le 2k + 1 \le n $ at least one collapse was performed at the vertex $ v_{2k + 1} $.
\end{claim}
\begin{proof}
Suppose that at least one collapse is made at the vertex $ v_{2k '+ 1} $ for all $ k' $ such that $ 3 \le 2k '+ 1 <2k + 1 $, and the vertex $ v_{2k + 1} $ was not collapsed. This means that the arc $ (u_{2k}, v_{2k + 1}) $belongs to the graph at the current iteration.

By definition, after a collapse from the vertex $ v_{2k '+ 1} $, a pair of arcs $ (u_{2k'}, u_{2k '+ 1}), (u_{2k' + 1}, u_{2k '+ 2}) $ is added to the graph. Moreover, any of these arcs can disappear from the graph only after a collapse from the vertex $ u_ {2k '+ 1} $. But $\lvl(u_ {2k '+ 1})= 1 $, and therefore it has not yet been visited by the Collapsing Algorithm. Therefore, both arcs belong to the graph at the current iteration.

Then there exists a weak path $ Q $ in the graph of the following form:

$$
Q = v_1 - v_2 - \dotsb - v_{2k+1} - u_{2k} - u_{2k-1} - \dotsb - u_2 \, .
$$

It means that $v_1$ and $u_2$ are weakly connected, which leads to a~contradiction.
\end{proof}

From Claim~\ref{lem:pathcollapse} we know that each $v_{2k+1}$ was collapsed. This implies that at the current iteration, for every $k$ such that $3\le 2k+1\le n$, the graph contains the weak path $ u_2 - \ldots - u_{2k} - u_{2k + 1} $. We will now show that $v_1$ and $u_2$ are weakly connected. To this end, we consider two cases $ \lvl (v_{n}) = 2 $ and $ \lvl (v_{n}) = 1 $. 

If $ \lvl (v_{n}) = 1 $, then, since every vertex $ v_{2k + 1} $ was collapsed at least once, there exist arcs $(u_{n-2},u_{n-1} ) $ and $ (u_{n-1}, v_n) $ in the graph. Hence, there exists a weak path of the form $ v_1 - v_2 - \dotsb - v_n - u_{2k + 1} - \dotsb - u_3 - u_2 $, and the vertices $ v_1 $ and $ u_2 $ are weakly connected (see an example in Figure~\ref{fig:lvl2n6pathvu}).

If $ \lvl (v_{n}) = 2 $, then $ n = 2k + 1 $ for some $ k $. Hence, by Claim~\ref{lem:pathcollapse}, at least one collapse was made from the vertex $ v_{2k + 1} $. On the other hand, the vertex $ v_{2k + 1} \notin V (s) $ (since we chose $t=v_n=v_{2k+1}$ as a vertex not from $V(s)$). Since $v_{2k+1}$ has not been examined yet, it could not be collapsed yet (see an example in Figure~\ref{fig:lvl2n5pathvu}).

\begin{figure}[ht]
\begin{center}

\begin{tikzpicture}[xscale=1.3] 
  \begin{scope}
    \foreach \x/\y/\n/\m in {2/3/v2/$v_2$, 4/3/v4/$v_4$}
      \node[inputvertex] (\n) at (\x,\y) {\m};
    \foreach \x/\y/\n/\m in {1/2/v1/$v_1$, 3/2/v3/$v_3$, 5/2/v5/$v_5$, 6/1/v6/$v_6$}
      \node[vertex] (\n) at (\x,\y) { \m};
    \foreach \x/\y/\n/\m in {0/1/u0/$u_0$, 1/0/u1/$u_1$, 2/1/u2/$u_2$, 3/0/u3/$u_3$, 4/1/u4/$u_4$, 5/0/u5/$u_5$}
      \node[vertex] (\n) at (\x,\y)  { \m};
    
    \foreach \y in {0,...,3}
      \node[draw=none] at (-1,\y) {\y};
      
    \path (v1) edge[->, ultra thick] (v2);
    \path (v2) edge[->, ultra thick] (v3);
    \path (v3) edge[->, ultra thick] (v4);
    \path (v4) edge[->, ultra thick] (v5);
    \path (v5) edge[->, ultra thick] (v6);
    
    \draw[->] (u0) to node [sloped] {\(\not\quad\)} (v1);
    \draw[->] (v1) to node [sloped] {\(\not\quad\)} (u2);
    \path (u2) edge[->, ultra thick] (u3);
    \path (u3) edge[->, ultra thick] (u4);
    \path (u4) edge[->, ultra thick] (u5);
    \path (u5) edge[->, ultra thick] (v6);
  \end{scope}
\end{tikzpicture}
\end{center}

\caption{A weak path connecting $v_1$ and $u_2$ for $n=6$.}\label{fig:lvl2n6pathvu}
\end{figure}

\begin{figure}[ht]
\begin{center}

\begin{tikzpicture}[xscale=1.3] 
  \begin{scope}
    \foreach \x/\y/\n/\m in {2/3/v2/$v_2$, 4/3/v4/$v_4$}
      \node[inputvertex] (\n) at (\x,\y) { \m};
    \foreach \x/\y/\n/\m in {1/2/v1/$v_1$, 3/2/v3/$v_3$, 5/2/v5/$v_5$}
      \node[vertex] (\n) at (\x,\y) { \m};
    \foreach \x/\y/\n/\m in {0/1/u0/$u_0$, 1/0/u1/$u_1$, 2/1/u2/$u_2$, 3/0/u3/$u_3$, 4/1/u4/$u_4$}
      \node[vertex] (\n) at (\x,\y) { \m};
    
    \foreach \y in {0,...,3}
      \node[draw=none] at (-1,\y) {\y};
      
    \path (v1) edge[->, ultra thick] (v2);
    \path (v2) edge[->, ultra thick] (v3);
    \path (v3) edge[->, ultra thick] (v4);
    \path (v4) edge[->, ultra thick] (v5);
    
    \draw[->] (u0) to node [sloped] {\(\not\quad\)} (v1);
    \draw[->] (v1) to node [sloped] {\(\not\quad\)} (u2);
    \path (u2) edge[->, ultra thick] (u3);
    \path (u3) edge[->, ultra thick] (u4);
    \path (u4) edge[->, ultra thick] (v5);
  \end{scope}
\end{tikzpicture}
\end{center}

\caption{A weak path connecting $v_1$ and $u_2$ for $n=5$.}\label{fig:lvl2n5pathvu}
\end{figure}

\paragraph{Analysis of vertices at the level \texorpdfstring{$1$}{1}.}

In this case, all the vertices at the levels $ 2 $ and $ 3 $ are already considered.

Note that the collapse from the vertex $ s $ can potentially violate only the connectivity of $ s $ and $ \varepsilon $. Therefore $ \varepsilon \notin C'_{cl} (s) $. Let us take an arbitrary vertex $ t \in C'_{cl}(s) \backslash V(s)$. Since the vertices at levels $2$ and $3$ have been considered by CA, $ \lvl (t) = 1 $.

Since $t$ is weakly connected to $s$, the vertex $ t $ is incident to at least one arc. But it cannot be connected with the vertex at the level $ 0 $, because only $ \varepsilon $ is located at this level, and $ \varepsilon \notin C'_{cl} (s) $. Hence, $ t $ is incident to at least one arc leading to the level $ 2 $. Moreover, since $ \indegree(t)=\outdegree(t)$, at least one arc from level $2$ comes to $ t $, and at least one such arc leaves $ t $.

We will identify vertices with the strings they correspond to. In particular, $ t $ corresponds to some string $ \tt b $ consisting of one symbol. We have just shown that there are arcs $ ({\tt xb}, {\tt b}) $ and $ ({\tt b}, {\tt bc}) $ for some symbols $ {\tt x} $ and $ {\tt c} $.

First we prove several auxiliary claims.

\begin{claim}
\label{lem:nobeps}
The Collapsing Algorithm did not have the arc $ ({\tt b}, \varepsilon) $ nor $ (\varepsilon, {\tt b}) $ in its partial solution at any previous iteration.
\end{claim}
\begin{proof}
If the partial solution of CA had one of these arcs, then it could loose it only after the collapse in the vertex $ {\tt b} $. Since this vertex $ {\tt b} $ has not been examined yet, this arc must still be in the current solution. But this would imply that $ \varepsilon \in C'_{cl} (s) $, and lead to a contradiction.
\end{proof}

\begin{claim}
\label{lem:bccsave}
Let {\tt a} be an arbitrary symbol. If any of the arcs \sedge{ba}{a}, \sedge{b}{ba}, or \sedge{ab}{b} was in the partial solution of CA at a previous step, then it still belongs to the partial solution until this iteration.
\end{claim}
\begin{proof}
We show a proof for the arc \sedge{ba}{a}, and the proofs for \sedge{b}{ba} and \sedge{ab}{b} are analogous.  Note the arc \sedge{ba}{a} can only be collapsed with the arc \sedge{b}{ba}. Then, if a collapse actually occurs at the vertex $ {\tt ba} $, it creates the arc $ ({\tt b}, \varepsilon) $. By Claim~\ref{lem:nobeps}, there never was any such arc in the graph. \end{proof}

\begin{lemma}
\label{lem:bbcone}
At the current iteration, there is exactly one copy of the arc \sedge{b}{bc}.
\end{lemma}
\begin{proof}
From the discussion above, we know that there must be at least one copy of the arc \sedge{b}{bc}. Assume that there are at least two such arcs. Then at least two arcs must leave $ {\tt bc} $.

Suppose that there exists at least one arc \sedge{bc}{c}. Then, if we make a collapse at the vertex $ {\tt bc} $, the vertices $ {\tt b} $, $ {\tt c} $, and $ {\tt bc} $ still remain weakly connected by the arcs \sedge{b}{bc}, $ ({\tt b}, \varepsilon) $, and $ (\varepsilon, {\tt c}) $. Hence, this collapse is valid (see Figure~\ref{fig:lvl1lemmabcc}), but the collapsing algorithm during the examination of the vertex $ {\tt bc} $ did not collapse it. This leads to a contradiction, so there is no arc \sedge{bc}{c} in the graph.

\begin{figure}[ht]
\begin{center}

\begin{tikzpicture}[xscale=1.2] 
  \begin{scope}
    \foreach \i in {0,...,1} {
        \foreach \x/\y/\n in {1/1/b, 2/2/bc, 3/1/c}
            \node[vertex] (\n\i) at (\i*4+\x,\y) {\tt \n};
        \node[vertex] (e\i) at (\i*4+2,0) {$\varepsilon$};
    }
    
    \foreach \y in {0,...,2}
      \node[draw=none] at (0,\y) {\y};
    
    \draw [-] (3.5,1.5) -- (3.56,1.5);
    \draw [->,decorate,decoration={snake, post length=0.4mm}] (3.56,1) -- (4.5,1);
    
    \path (b0) edge[->, bend left=15] (bc0);
    \path (b0) edge[->, bend right=15] (bc0);
    \path (bc0) edge[->] (c0);

    \path (b1) edge[->, bend left=15] (bc1);
    \path (b1) edge[->, dashed, bend right=15] (bc1);
    \path (bc1) edge[->, dashed] (c1);
    \path (b1) edge[->] (e1);
    \path (e1) edge[->] (c1);
  \end{scope}
\end{tikzpicture}
\end{center}

\caption{Correctness of the collapse in the case when the graph contains the arc \sedge{bc}{c}.}\label{fig:lvl1lemmabcc}
\end{figure}

Therefore, there is at least one arc \sedge{bc}{bcd}. Then $ {\tt bcd} \in {\cal S} $ must be an input string. Therefore, the original graph contained two copies of the arcs \sedge{bc}{bcd} and \sedge{bcd}{cd}. So, at least one collapse was done in the vertex {\tt bcd}, and it created the arc \sedge{bc}{c}. But at the current iteration the arc \sedge{bc}{c} does not exist, so it was also collapsed. This contradicts Claim~\ref{lem:bccsave}.
\end{proof}

\begin{figure}[ht]
\begin{center}

\begin{tikzpicture}[xscale=1.2] 
  \begin{scope}
    \foreach \i in {0,...,2} {
        \foreach \x/\y/\n in {1/1/b, 2/2/bc, 3/1/c}
            \node[vertex] (\n\i) at (\i*4+\x,\y) {\tt \n};
        \node[inputvertex] (bcd\i) at (\i*4+3,3) {\tt bcd};
        \node[vertex] (e\i) at (\i*4+2,0) {$\varepsilon$};
    }
    
    \foreach \y in {0,...,3}
      \node[draw=none] at (0,\y) {\y};
    
    \draw [-] (3.5,1.5) -- (3.56,1.5);
    \draw [->,decorate,decoration={snake, post length=0.4mm}] (3.56,1.5) -- (4.5,1.5);
    
    \draw [-] (7.5,1.5) -- (7.56,1.5);
    \draw [->,decorate,decoration={snake, post length=0.4mm}] (7.56,1.5) -- (8.5,1.5);
    
    \path (b0) edge[->, bend left=15] (bc0);
    \path (b0) edge[->, bend right=15] (bc0);
    \draw[->] (bc0) to node [sloped] {\(\not\quad\)} (c0);
    
    \path (b1) edge[->, bend left=15] (bc1);
    \path (b1) edge[->, bend right=15] (bc1);
    \draw[->] (bc1) to node [sloped] {\(\not\quad\)} (c1);
    \path (bc1) edge[->, bend left=15] (bcd1);
    \path (bc1) edge[->, bend right=15] (bcd1);
    
    \path (b2) edge[->, bend left=15] (bc2);
    \path (b2) edge[->, bend right=15] (bc2);
    \path (bc2) edge[->, ultra thick] (c2);
    \path (bc2) edge[->, bend left=15] (bcd2);
    \path (bc2) edge[->, bend right=15, dashed] (bcd2);
  \end{scope}
\end{tikzpicture}
\end{center}

\caption{The scheme of the proof of Lemma~\ref{lem:bbcone}.}\label{fig:lvl1lemmabbcone}
\end{figure}

%So, there is only one arc \sedge{b}{bc}.

\begin{claim}
\label{lem:bcup}
The vertex $ {\tt bc} $ is weakly connected to at least one vertex at the level $ 3 $.
\end{claim}
\begin{proof}
Assume towards a contradiction that $ {\tt bc} $ is not connected to vertices at level $3$. Then $ {\tt bc} $ can only be incident to arcs \sedge{b}{bc} and \sedge{bc}{c}. By Lemma~\ref{lem:bbcone}, there is only one copy of the arc \sedge{b}{bc}. Hence, there is exactly one copy of the arc \sedge{bc}{c}. In this case, the Collapsing Algorithm had to collapse this pair of arcs when examining $ {\tt bc} $ (because this operation would only separate $ {\tt bc} $ from all other vertices without violating the connectivity of $ \varepsilon $ and $ {\cal S} $). This contradiction implies that the vertex $ {\tt bc} $ is connected to a vertex on the level $3$.
\end{proof}

By Claim~\ref{lem:bcup}, either there exists $ {\tt d} $ such that there is an arc \sedge{bc}{bcd}, or there is a symbol $ {\tt a} $ such that there is an arc \sedge{abc}{bc}. Suppose there is no such $ {\tt a} $, which implies that there must be some $ {\tt d} $.

Then $ {\tt bcd} \in {\cal S} $, and, therefore, initially there were two copies of the arcs \sedge{bc}{bcd} and \sedge{bcd}{cd} in the graph. So, at least one collapse was made at the vertex {\tt bcd}, and it created the arc \sedge{bc}{c}. The arc \sedge{bc}{c} could not be collapsed by Claim~\ref{lem:bccsave}. Hence, some other arc must come to $ {\tt bc} $, and, by Lemma~\ref{lem:bbcone}, it cannot be another copy of \sedge{b}{bc}.

Hence, there is an $ {\tt a} $ such that there is an arc \sedge{abc}{bc}. Then $ {\tt abc} \in {\cal S} $, and from $ {\tt abc} $ exactly one collapse was made, which created two arcs \sedge{ab}{b} and \sedge{b}{bc}, which were not collapsed until now by Claim~\ref{lem:bccsave}.

Therefore, $ {\tt bc} $ contains at least two arcs: \sedge{abc}{bc} and \sedge{b}{bc}. Hence, at least two arcs leave $ {\tt bc} $.

\begin{claim}
\label{lem:bccexist}
At the current iteration, there is at least one arc \sedge{bc}{c}.
\end{claim}
\begin{proof}
Assume there is no arc \sedge{bc}{c}. Then, since at least one arc must leave $ {\tt bc} $, it is an arc of the form \sedge{bc}{bcd}. So, $ {\tt bcd} \in {\cal S} $. Again, initially the graph contained two instances of the arcs \sedge{bc}{bcd} and \sedge{bcd}{cd}, and there was made at least one collapse at the vertex {\tt bcd}. This collapse created the arc \sedge{bc}{c}, a contradiction.
\end{proof}

So, by Lemma~\ref{lem:bbcone}, there is one arc \sedge{b}{bc} in the graph, and by Claim~\ref{lem:bccexist} there is at least one arc \sedge{bc}{c}.

We will now show that this pair of arcs should have been collapsed, which will contradict Claim~\ref{lem:bccsave}.
Indeed, even after this collapse, there will be weak paths $ {\tt b} - \varepsilon - {\tt c} $ and $ {\tt b} - {\tt ab} - {\tt abc} - {\tt bc} $, and hence the connectivity of the vertices $ {\tt b} $, $ {\tt c} $ and $ {\tt bc} $ will be preserved (see Figure \ref{fig:lvl1final}).
\begin{figure}[ht]
\begin{center}

\begin{tikzpicture}[xscale=1.3] 
  \begin{scope}
    \foreach \x/\y/\n in {1/2/ab, 2/1/b, 3/2/bc, 4/1/c}
      \node[vertex] (\n) at (\x,\y) {\tt \n};
      
    \node[inputvertex] (abc) at (2,3) {\tt abc};
    \node[vertex] (e) at (3,0) {$\varepsilon$};
    
    \foreach \y in {0,...,3}
      \node[draw=none] at (0,\y) {\y};
    
    \foreach \s/\t in {ab/b, ab/abc, abc/bc}
      \path (\s) edge[->] (\t);
    
    \draw[->] (b) to node [sloped] {\(\not\quad\)} (bc);
    \draw[->] (bc) to node [sloped] {\(\not\quad\)} (c);
    
    \path (b) edge[->, dashed] (e);
    \path (e) edge[->, dashed] (c);
  \end{scope}
\end{tikzpicture}
\end{center}

\caption{After the collapse at the vertex $ {\tt bc} $, the vertices $ {\tt b} $, $ {\tt c} $ and $ {\tt bc} $ will still belong to one weakly connected component. The removed arcs are crossed out, and the new arcs are dashed.}\label{fig:lvl1final}
\end{figure}

This completes the proofs of Lemma~\ref{lem:technical} and Theorem~\ref{thm:main}.