% !TEX encoding = windows-1251
% !TEX program = pdflatex
\documentclass[11pt]{article}
\usepackage[cp1251]{inputenc}
%\usepackage[T2A]{fontenc}
%\usepackage[russian]{babel}
\usepackage{subcaption}
\usepackage{amssymb,amsmath}
\usepackage{multicol}
\pagestyle{empty}
\usepackage{graphicx}
\textheight=25cm
\textwidth=18cm
\oddsidemargin=-1cm
\topmargin=-2.5cm
\newtheorem{lem}{Lemma}
\DeclareMathOperator{\suff}{suff}
\DeclareMathOperator{\pref}{pref}
\DeclareMathOperator{\overlap}{overlap}

\begin{document}
	\begin{lem}
		For any set of strings $\mathcal{S}$,
		\begin{gather*}
			D := CA(\mathcal{S}, GHA(\mathcal{S}) \sqcup GHA(\mathcal{S})) = GHA(\mathcal{S}).
		\end{gather*}
	\end{lem}
	{\em Proof.} Let us denote by $D'$ and $D''$ the first and the second copy of $GHA(\mathcal{S})$ in doubled solution and for convenience assume that arcs in $D'$ and $D''$ are painted in red and blue, respectively. Since $CA$ collapses the pairs of arcs at each vertex in arbitrary order, we can assume without loss of generality, that if for any vertex $v$ $CA$ can collapse a blue pair of arcs $(\pref(v), v), (v, \suff(v))$, it does it. Let us denote by $\overline{D}_i$ a partial solution of $CA$ constructed till level $i$ and by $D_i$ its part above level $i$. 	
	
	We are going to prove by induction that for every $i$ $D_i$ coincides with the part $D'_i$ of $D'$ above level $i$. For $i = l := \max\{|s| \, : \, s\in\mathcal{S}\}$ the claim is trivial since $D_l$ and $D'_l$ have no arcs. Assume that the claim is true for $i = k > 0$ and prove it is also true for $i = k - 1$. Note, that if $D_k = D'_k$, then all collapsed pairs of arcs till now were blue and all blue arcs above level $k$ were collapsed. Since sequential descending collapse of blue pairs doesn't break connectivity of blue graph, we can conclude, that blue subgraph in $\overline{D}_k$ is still cycle and then all {\em blue degrees} are balanced. This means, that if for any vertex $v$ on level $k$ there is an arc $(\pref(v), v)$ then there is also an arc $(v, \suff(v))$ and vice versa. Hence, all pairs collapsed at level $k$ will be one-colored.
	
	Now let us show, that no red pair can be collapsed. Indeed, if for some vertex $v$ on level $k$ there is a red pair $(\pref(v), v)$, $(v, \suff(v))$, then by construction of $GHA$ $v$ is either in $\mathcal{S}$ or is the last chance of the corresponding component $\mathcal{C} \ni v$ to be connected to the rest arcs in $D'$ (note, that the first case is subcase of the second one, as then $\mathcal{C}$ contains only one vertex). It follows, that if $CA$ decide to collapse such pair, then $v$ has no blue pairs (and hence blue incident arcs) and all other vertex in $\mathcal{C}$ at the level $k$ are fully collapsed (since $v$ is the last vertex in $\mathcal{C}$ in lexicographic order). Therefore, this pair is also the last chance of $\mathcal{C}$ to be connected to the rest arcs in $\overline{D}_i$ and then $CA$ cannot collapse it.
	
	It remains to show that all blue pairs on level $k$ will be collapsed. This is true, since no red pair is collapsed and hence connectivity of $\overline{D}_i$ is provided by $D'$. Thus, proof is completed.
	
	To prove the lemma, note that $D = \overline{D}_0 = D_0 = D'_0 = D'$. $\square$
	
\end{document}
